<?xml version="1.0" encoding="UTF-8"?>
<thing:thing-descriptions bindingId="mqtt"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:thing="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0"
	xsi:schemaLocation="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0 http://eclipse.org/smarthome/schemas/thing-description-1.0.0.xsd">

	<bridge-type id="broker">
		<label>MQTT Broker</label>
		<description>A connection to a MQTT broker</description>

		<config-description>
			<parameter name="host" type="text" required="true">
				<label>Broker Hostname/IP</label>
				<description>The IP/Hostname of the MQTT broker</description>
				<context>network-address</context>
			</parameter>

			<parameter name="port" type="integer">
				<label>Broker Port</label>
				<description>The port is optional, if none is provided, the typical
					ports 1883 and 8883 (SSL) are used.</description>
				<context>network-address</context>
				<advanced>true</advanced>
			</parameter>

			<parameter name="secure" type="text" required="true">
				<label>Secure connection</label>
				<description>Uses TLS/SSL to establish a secure connection to the
					broker. Can be "OFF","ON","AUTO". The AUTO setting prefers a secure
					connection but will fall-back to an insecure one. Default is ON.</description>
				<options>
					<option value="ON">Enabled</option>
					<option value="OFF">Disabled</option>
					<option value="AUTO">Automatic</option>
				</options>
			</parameter>

			<parameter name="qos" type="integer">
				<label>Quality of Service</label>
				<options>
					<option value="0">At most once (0)</option>
					<option value="1">At least once (1)</option>
					<option value="2">Exactly once (2)</option>
				</options>
				<default>0</default>
				<advanced>true</advanced>
			</parameter>

			<parameter name="clientid" type="text">
				<label>Client ID</label>
				<description>Use a fixed client ID. Defaults to empty which means a
					user ID is generated for this connection.</description>
				<advanced>true</advanced>
			</parameter>

			<parameter name="retain" type="boolean">
				<label>Retain messages</label>
				<description>Retained messages are stored on the MQTT broker and
					other clients can retrieve the value at any time</description>
				<default>true</default>
				<advanced>true</advanced>
			</parameter>

			<parameter name="reconnect_time" type="integer">
				<label>Reconnect time</label>
				<description>Reconnect time in ms. If a connection is lost, the
					binding will wait this time before it tries to reconnect.</description>
				<default>60000</default>
				<advanced>true</advanced>
			</parameter>

			<parameter name="keep_alive_time" type="integer">
				<label>Heartbeat</label>
				<description>Keep alive / heartbeat timer in ms. It can take up to
					this time to determine if a server connection is lost. A lower
					value may keep the broker unnecessarily busy for no or little
					additional value.</description>
				<default>60000</default>
				<advanced>true</advanced>
			</parameter>

			<parameter name="lastwill_message" type="text">
				<label>Last will message</label>
				<description>The last will message.</description>
				<advanced>true</advanced>
			</parameter>

			<parameter name="lastwill_topic" type="text">
				<label>Last will topic</label>
				<description>Defaults to empty and therefore disables the last will.</description>
				<advanced>true</advanced>
			</parameter>

			<parameter name="lastwill_qos" type="integer">
				<label>Last will QoS</label>
				<description>The quality of service parameter of the last will.</description>
				<options>
					<option value="0">At most once (0)</option>
					<option value="1">At least once (1)</option>
					<option value="2">Exactly once (2)</option>
				</options>
				<default>0</default>
				<advanced>true</advanced>
			</parameter>

			<parameter name="username" type="text">
				<label>Username</label>
				<description>The MQTT username</description>
				<advanced>true</advanced>
			</parameter>
			<parameter name="password" type="text">
				<label>Password</label>
				<description>The MQTT password</description>
				<context>password</context>
				<advanced>true</advanced>
			</parameter>
			<parameter name="certificatepin" type="boolean">
				<label>Certificate pinning</label>
				<description>If this and SSL is set: After the next connection has
					been successfully established, the certificate is pinned. The
					connection will be refused if another certificate is used. Clear
					**certificate** to allow a new certificate for the next connection
					attempt. This option can increase security.</description>
				<default>true</default>
				<advanced>true</advanced>
			</parameter>
			<parameter name="certificate" type="text">
				<label>Certificate hash</label>
				<description>If **certificatepin** is set this hash is used to
					verify the connection. Clear to allow a new certificate pinning on
					the next connection attempt. If empty will be filled automatically
					by the next successful connection. An example input would be
					`SHA-256:83F9171E06A313118889F7D79302BD1B7A2042EE0CFD029ABF8DD06FFA6CD9D3`.</description>
				<advanced>true</advanced>
			</parameter>
			<parameter name="publickeypin" type="boolean">
				<label>Public key pinning</label>
				<description>If this and SSL is set: After the next connection has
					been successfully established, the public key of the broker is
					pinned. The connection will be refused if another public key is
					used. Clear **publickey** to allow a new public key for the next
					connection attempt. This option can increase security.</description>
				<default>true</default>
				<advanced>true</advanced>
			</parameter>
			<parameter name="publickey" type="text">
				<label>Public Key Hash</label>
				<description>If **publickeypin** is set this hash is used to verify
					the connection. Clear to allow a new public key pinning on the next
					connection attempt. If empty will be filled automatically by the
					next successful connection. An example input would be
					`SHA-256:83F9171E06A313118889F7D79302BD1B7A2042EE0CFD029ABF8DD06FFA6CD9D3`</description>
				<advanced>true</advanced>
			</parameter>
		</config-description>
	</bridge-type>

	<bridge-type id="systemBroker">
		<label>System MQTT Broker</label>
		<description>A system configured and therefore read-only broker
			connection. Properties are reflecting the configuration and internal
			connection status.</description>

		<properties>
			<property name="url" />
			<property name="username" />
			<property name="password" />
			<property name="qos" />
			<property name="retain" />
			<property name="lastwill" />
			<property name="reconnect_time_ms" />
			<property name="keep_alive_time_ms" />
		</properties>
	</bridge-type>
</thing:thing-descriptions>
